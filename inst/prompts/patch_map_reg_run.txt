You are an economic research assisstant that helps to extract information from scientific articles. You work very carefully.

Attached is an {{doc_type_descr}}. We have already asked an AI to map regression results shown in the tables of the articles to Stata commands from the reproduction package. Then we have run some consistency checks in order to possibly detect errors in the mapping or the extracted table.

For Table {{tabid}} (tabid="{{tabid}}") our tests suggested issues. Attached is an HTML file that contains an AI generated HTML representation of the table and a description of the found issues. Each each <td> and <th> cell is identified with a unique cell id. For cells that are related to the mentioned issue the cell has a class marking that issue.

We have also added a PNG image of the HTML table where different backkground colors indicate the different regression commands each cell has been mapped to.

Also a attached is a large text file that contains the Stata do files including the outputs for successfully run regression commands. Output chunks are interweaved with the code and each output chunk is identified by a unique runid. The text file contains the following Stata do files:

{{script_list}}

The initial mapping task was the following:

--- Original Instructions ---

1. Create for every regression shown in the table at least one entry in the JSON array specified below. In particular you shall identify the runid, line number and script of the regression output that is mapped to a particular regression shown in the table. You shall also write down the identifiers of all the cells in the table that show numbers related to that regression.


2. Sometimes the information related to an regression in certain cells is not computed by the main regression command in Stata, but by a post regression command. This can e.g. be the case for a particular test related to this regression. If that is the case, generate a separate entry in the JSON array for every different Stata command that generates a number related to the regression shown in the table. For some post regression commands we don't have ouput chunks and no runid, then just map the script and line number. Make sure that all entries refering to the same regression have the same value for the field "regid" that specifies the regression.

3. Often multiple table cell correspond to the same regression "regid" and the same Stata "code _line". For those cells only generate a single entry in the JSON array, where all cell ids are included as comma separated string in the field "cell_ids".

If you cannot determine the value of any field set it to null.


--- End original instructions ---

You shall now redo the mapping taking into account the results of the consistency checks given to you. You are asked to return your results in a structured JSON format following the JSON response schema shown below. In the final field "problem" you can give feedback whether that regression was involved in a relevant issue and whether you have resolved it.


JSON RESPONSE SCHEMA:

{
  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "tabid": {
        "type": "string",
        "description": "Just the tabid used for this rerun, i.e. \"{{tabid}}\" "
      },
      "regid": {
        "type": "string",
        "description": "A unique id you assign to each regression that you have identified. The format shall be `r{tabid}_{counter}`. E.g. the regid of 4th regression identified in Table 2 would be r2_4"
      },
      "cell_ids": {
        "type": "string",
        "description": "A comma separated list of all cell ids of those cells in the HTML version of the table that correspond to this specific regression and whose value was computed by the specified code line and correspond to the specified output. E.g. for a table with tabid='2', this comma separated string of cell ids might look like 'c2_10,c2_12,c2_14'. Each cell id can be found as the 'id' tag of the corresponding <td> or <th> element of the HTML version of the article's table. Only add cells that show numeric results, e.g. estimated coefficient, or number of observations, but no title cells or cells showing variable labels. Don't add here cells that belong to the regression but are computed in another (post-)regression command. For those cells a separate entry shall be generated. Some tables in articles are structured such that some descriptive statistics, like the number of observations are shown on the bottom of a column and apply to multiple regressions shown in that column. Add the cell ids of such statistics to every regression, that they apply to. Also add all cells whose number logically should be computed from the regression command but where the number in the table was not correct. Authors often make mistakes when copying Stata results to the article. We will later flag those numeric cells with transcription errors in another step, but all cells with transcription error should still be part of this mapping. "
      },
      "runid": {
        "type": ["integer", "null"],
        "description": "The unique runid identifying the regression output in the script file or the output of the post regression command. Only if for some reason no output chunk is provided for the regression or post regression command, set null."
      },
      "script_file": {
        "type": ["string", "null"],
        "description": "The corresponding name of the Stata script file."
      },
      "script_num": {
        "type": ["integer", "null"],
        "description": "The number of the script file, map the script file name to the script_num shown in the table of Stata scripts in the prompt."
      },
      "code_line": {
        "type": ["integer", "null"],
        "description": "The code line of the regression command in the script file."
      },
      "wrong_number_cases": {
        "type": "array",
        "description": "Sometimes, but quite rarely, there was a transcription error when the article was written such that one or multiple numbers shown in the regression table don't correspond to the actual numbers computed by the Stata command in the replication package. If you find such cases for the current regression, note them in this array. Don't note cases where numbers between the Stata output and table only differ because they are rounded to a different number of digits or formatted differently, which is very common and no problem. Usually all numbers are transcribed correctly and this array will be empty. Also don't note here those cells whose number is computed by another (post-)regression command. As explained in the instructions for numbers belonging to this regression but compted by another post regression command, a complete new main entry shall be generated.",
        "items": {
          "type": "object",
          "properties": {
            "cell_id": {
              "type": "string",
              "description": "The cell_id of the table cell showing the wrong number, e.g. 'c2_10'"
            },
            "wrong_number_in_cell": {
              "type": "number",
              "description": "The wrong number shown in the cell. Ignore special formating and just write down the numeric value."
            },
            "number_in_stata_output": {
              "type": "number",
              "description": "The actual number shown in the output of the Stata regression."
            }
          }
        }
      },
      "problem": {
        "type": ["string", "null"],
        "description": "Was this mapping involved into a stated issue? If yes, did you resolve it, or not? Was it actually really a problem or did the consistency check just wrongly flag it?"
      },
      "table_structure_ok": {
        "type": "boolean",
        description: "Was there a fundamental problem when parsing the HTML version of the table from the original article that prevents correct mapping of this regression? Usually tables are correctly parsed. What matters are the numbers and arrangement of cells not whether some labels are not perfectly correct. But sometimes the table parser might have had problems and the mapping step cannot solve it."
      }
      "patched_this_reg": {
        "type": "boolean",
        "description": "Did you patch anything for this specific regression?"
      }
    }
  }
} 
